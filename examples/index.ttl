
@prefix logset: <https://raw.githubusercontent.com/NERSC/LogSet/master/etc/vocab#> .
@prefix dict: <https://raw.githubusercontent.com/NERSC/LogSet/master/etc/dict#> .
@prefix entities: <http://portal.nersc.gov/project/m888/resilience/entities/#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .

# possible addition to vocab:
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

## it turns out that dct:temporal is not directly comparable with xsd:date,
## making it fairly useless for sparql queries. Following the pattern used by 
## DDI Alliance and OpenGeoSpatial.org we define startDate and endDate properties
## for a dct:PeriodOfTime and make an anonymous resource with these properties for 
## each dct:temporal property 
## (incidentally, DDI stands for "Data Documentation Initiative", which ironically, 
## is not documented anywhere on their website)
## note that for sparql queries to work, the dates *must* be include a timezone
## and be marked as ^^xsd:dateTime, both in the index and in the query (or they 
## get compared as literals). The time part (eg T12:00:00) is optional 
#@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
#@prefix owl: <http://www.w3.org/2002/07/owl#> .
#logset:startDate
#    a owl:DatatypeProperty ;
#    rdfs:domain dct:PeriodOfTime ;
#    rdfs:range xsd:dateTime ;
#    .
#
#logset:endDate
#    a owl:DatatypeProperty ;
#    rdfs:domain dct:PeriodOfTime;
#    rdfs:range xsd:dateTime ;
#    .


_:sample_data
    a logset:LogSet ;
    dct:description "a partial sample of cori log data for testing logset tools"  ;
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-06T15:18:20.827169-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-07T15:22:42.809617-07:00"^^xsd:dateTime ;
                 ] ;
    logset:subject entities:cori ;
    dcat:distribution
        _:console-20170906,
        _:console-20170907,
        _:consumer-20170906,
        _:consumer-20170907, 
        _:messages-20170906,
        _:messages-20170907 ;
    .

_:console-20170906
    a logset:ConcreteLog ;
    # this would normally be like:
    #dcat:downloadURL <file://cori.nersc.gov//global/cscratch1/sd/sleak/p0-20170906t151820/console-20170906>
    # but for the example we'll use a literal (also relative) path:
    dcat:downloadURL "p0-20170906t151820/console-20170906" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:console_logfile ; 
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-06T15:20:21.827169-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-06T15:22:42.809617-07:00"^^xsd:dateTime ;
                 ] ;
    #dct:temporal "start=2017-09-06T15:20:21.827169-07:00 end=2017-09-06T15:22:42.809617-07:00" ;
    ## try this:
    #dct:date "2017-09-06T15:20:21.827169-07:00"^^xsd:dateTime
    .
    
_:console-20170907
    a logset:ConcreteLog ;
    dcat:downloadURL "p0-20170906t151820/console-20170907" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:console_logfile ; 
    #dct:temporal "start=2017-09-07T00:00:37.627889-07:00 end=2017-09-07T00:01:31.068610-07:00" ;
    #dct:date "2017-09-07T15:20:21.827169-07:00"^^xsd:dateTime
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-07T00:00:37.627889-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-07T00:01:31.068610-07:00"^^xsd:dateTime ;
                 ] ;
    .
    
_:consumer-20170906
    a logset:ConcreteLog ;
    dcat:downloadURL "p0-20170906t151820/consumer-20170906" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:consumer_logfile ; 
    # what if we have incomplete date info?
    #dct:temporal "start=2017-09-06T00:00:00" ;
    #dct:date "2017-09-06T15:20:21.827169-07:00"^^xsd:dateTime
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-06T00:00:00"^^xsd:dateTime ; 
                 ] ;
    .
    
_:consumer-20170907
    a logset:ConcreteLog ;
    dcat:downloadURL "p0-20170906t151820/consumer-20170907" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:consumer_logfile ; 
    #dct:temporal "start=2017-09-07T00:00:00" ;
    #dct:date "2017-09-07T15:20:21.827169-07:00"^^xsd:dateTime
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-07T00:00:00-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-07T23:59:59-07:00"^^xsd:dateTime ;
                 ] ;
    .
    
_:messages-20170906
    a logset:ConcreteLog ;
    dcat:downloadURL "p0-20170906t151820/messages-20170906" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:messages_logfile ; 
    #dct:temporal "start=2017-09-06T15:26:39.977558-07:00 end=2017-09-06T15:29:17.665618-07:00" ;
    #dct:date "2017-09-06T15:20:21.827169-07:00"^^xsd:dateTime
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-06T15:26:39.977558-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-06T15:29:17.665618-07:00"^^xsd:dateTime ;
                 ] ;
    .
    
_:messages-20170907
    a logset:ConcreteLog ;
    dcat:downloadURL "p0-20170906t151820/messages-20170907" ;
    dcat:mediaType "text/plain" ;
    logset:isInstanceOf dict:messages_logfile ; 
    #dct:temporal "start=2017-09-07T00:00:01.008501-07:00 end=2017-09-07T00:00:01.135482-07:00" ;
    #dct:date "2017-09-07T15:20:21.827169-07:00"^^xsd:dateTime
    dct:temporal [ a dct:PeriodOfTime ; 
                  logset:startDate "2017-09-07T00:00:01.008501-07:00"^^xsd:dateTime ; 
                  logset:endDate "2017-09-07T00:00:01.135482-07:00"^^xsd:dateTime ;
                 ] ;
    .
    

##########
#_:consumer-20170906
#    a logset:File ;
#    logset:path "p0-20170906t151820/consumer-20170906" ;
##    dcat:mediaType "text/plain" ;
#    logset:isLogOf logset:consumer_logfile ;
#    .
#    
#_:consumer-20170907
#    a logset:File ;
#    logset:path "p0-20170906t151820/consumer-20170907" ;
#    dcat:mediaType "text/plain" ;
#    logset:isLogOf logset:consumer_logfile ;
#    .


#11:27 sleak@cori07:examples$ ll p0-20170906t151820/
#total 12465
#-rw-rw---- 1 sleak sleak    1599 Dec 21 14:46 console-20170906
#-rw-rw---- 1 sleak sleak    2149 Dec 21 14:46 console-20170907
#-rw-rw---- 1 sleak sleak   29152 Dec 21 14:53 consumer-20170906
#-rw-rw---- 1 sleak sleak   47077 Dec 21 14:56 consumer-20170907
#-rw-r----- 1 sleak sleak 6071843 Dec 21 14:58 craylog.p0-20170906t151820
#-rw-rw---- 1 sleak sleak    2807 Dec 21 14:58 dumpd-20170906
#drwxrwx--- 2 sleak sleak     512 Dec 21 15:03 dws
#-rw-r----- 1 sleak sleak 6176800 Dec 21 14:59 hwerrlog.p0-20170906t151820
#-rw-rw---- 1 sleak sleak  218839 Dec 21 14:59 messages-20170906
#-rw-rw---- 1 sleak sleak  126622 Dec 21 14:59 messages-20170907
#drwxrwx--- 2 sleak sleak   32768 Dec 21 15:06 nersc.aries_lcb

